이 과제는 **STM32H750VBT6 마이크로컨트롤러와 microSD 카드, USB MTP 프로토콜을 활용해, Windows PC에서 오직 `.hwp`와 `.doc` 문서 파일만 저장할 수 있는 USB 장치를 만드는 프로젝트**입니다. 전체 구조와 목표를 이해하기 쉽게 요약하면 다음과 같습니다:

---

## 📌 **과제 개요 (개략적 설명)**

### 🎯 목표

* **특정 문서 파일(`.hwp`, `.doc`)만 저장 가능**한 USB 장치 제작
* **Windows PC에서 드라이버 설치 없이** 자동 인식 및 사용
* **STM32 마이컴 + microSD 카드**를 활용한 **스마트 저장 장치** 구현

---

### 🧩 구성요소와 역할

| 구성 요소                   | 역할                               |
| ----------------------- | -------------------------------- |
| **STM32H750VBT6**       | 마이크로컨트롤러 (두뇌) – USB, SD 제어       |
| **microSD 카드**          | 실제 데이터를 저장하는 메모리                 |
| **USBX + MTP (USB 스택)** | PC와 파일 송수신 (MSC 대신 MTP 사용)       |
| **FatFs**               | SD 카드에 파일을 읽고 쓰기 위한 파일 시스템       |
| **파일 필터링 로직**           | `.hwp`, `.doc` 확장자만 허용 (펌웨어에 구현) |

---

### ⚙️ 동작 방식

1. **STM32가 USB 장치(MTP)로 동작** → Windows 탐색기에서 "기기"로 인식됨
2. **사용자가 PC에서 파일을 전송**하면,
3. STM32는 수신 파일의 **확장자를 검사**

   * `.hwp`나 `.doc`면 **microSD에 저장**
   * 그 외의 파일은 **저장 거부**
4. **파일 시스템은 FatFs**를 사용하여 microSD에 저장

---

### 🚫 왜 MTP이고 MSC가 아닌가?

* \*\*MSC(Mass Storage Class)\*\*는 Windows에서 microSD 전체를 디스크로 인식함 → 사용자가 **모든 파일을 직접 조작** 가능 (제한 불가)
* \*\*MTP(Media Transfer Protocol)\*\*는 파일 단위 전송 → **STM32가 어떤 파일을 저장할지 제어 가능**

  * → 따라서 `.hwp`, `.doc`만 저장하도록 제한 가능

---

### 💡 기술적 핵심

* **FatFs**를 통해 microSD 접근
* **USBX의 MTP 클래스**를 통해 Windows와 통신
* **파일 저장 직전, 확장자를 검사**해 허용된 파일만 저장

  ```c
  if (strcmp(ext, ".hwp") == 0 || strcmp(ext, ".doc") == 0) {
      f_write(...); // 저장 허용
  } else {
      return UX_ERROR; // 저장 거부
  }
  ```

---

### 🧪 테스트 시나리오

* Windows에서 STM32 장치를 연결하면 MTP 장치로 보임
* `.doc` 파일 → 저장됨 ✅
* `.jpg`, `.exe` 파일 → 저장 실패 ❌
* SD카드는 FAT32 포맷 필수 (Windows 호환성)

---

이 프로젝트는 **임베디드 시스템, USB 프로토콜, 파일시스템, 보안 필터링**이 통합된 응용 시스템 예제로, STM32를 이용한 **파일 접근 제어 기반 스마트 저장 장치** 구현이라는 점에서 교육적·기술적 가치가 높습니다.
